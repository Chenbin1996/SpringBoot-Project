<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.ruxuanwo.template.mapper.SysDepartmentMapper">    <resultMap id="department" type="com.ruxuanwo.template.domain.SysDepartment">        <id column="id" property="id"/>        <result column="name" property="name"/>        <result column="short_name" property="shortName"/>        <result column="grade" property="grade"/>        <result column="pid" property="pid"/>        <result column="create_time" property="createTime"/>        <result column="create_user" property="createUser"/>        <result column="status" property="status"/>        <result column="sort_order" property="sortOrder"/>        <result column="primary_person" property="primaryPerson"/>        <result column="deputy_person" property="deputyPerson"/>        <result column="remark" property="remark"/>    </resultMap>    <sql id="sql_insert_column_list">        <trim prefix="" prefixOverrides=",">            <if test="id != null and id != ''">,id</if>            <if test="name != null and name != ''">,name</if>            <if test="shortName != null and shortName != ''">,short_name</if>            <if test="grade != null and grade != ''">,grade</if>            <if test="pid != null and pid != ''">,pid</if>            <if test="createTime != null">,create_time</if>            <if test="createUser != null and createUser != ''">,create_user</if>            <if test="status != null and status != ''">,status</if>            <if test="sortOrder != null and sortOrder != ''">,sort_order</if>            <if test="primaryPerson != null and primaryPerson != ''">,primary_person</if>            <if test="deputyPerson != null and deputyPerson != ''">,deputy_person</if>            <if test="remark != null and remark != ''">,remark</if>        </trim>    </sql>    <sql id="sql_insert_property_list">        <trim prefix="" prefixOverrides=",">            <if test="id != null and id != ''">,#{id}</if>            <if test="name != null and name != ''">,#{name}</if>            <if test="shortName != null and shortName != ''">,#{shortName}</if>            <if test="grade != null and grade != ''">,#{grade}</if>            <if test="pid != null and pid != ''">,#{pid}</if>            <if test="createTime != null">,#{createTime}</if>            <if test="createUser != null and createUser != ''">,#{createUser}</if>            <if test="status != null and status != ''">,#{status}</if>            <if test="sortOrder != null and sortOrder != ''">,#{sortOrder}</if>            <if test="primaryPerson != null and primaryPerson != ''">,#{primaryPerson}</if>            <if test="deputyPerson != null and deputyPerson != ''">,#{deputyPerson}</if>            <if test="remark != null and remark != ''">,#{remark}</if>        </trim>    </sql>    <sql id="sql_column_list">        <trim prefix="" prefixOverrides=",">            ,id            ,name            ,short_name            ,grade            ,pid            ,create_time            ,create_user            ,status            ,sort_order            ,primary_person            ,deputy_person            ,remark        </trim>    </sql>    <sql id="sql_update_set">        <trim prefix="SET" prefixOverrides=",">            <if test="id != null and id != ''">,id = #{id}</if>            <if test="name != null and name != ''">,name = #{name}</if>            <if test="shortName != null and shortName != ''">,short_name = #{shortName}</if>            <if test="grade != null and grade != ''">,grade = #{grade}</if>            <if test="pid != null and pid != ''">,pid = #{pid}</if>            <if test="createTime != null">,create_time = #{createTime}</if>            <if test="createUser != null and createUser != ''">,create_user = #{createUser}</if>            <if test="status != null and status != ''">,status = #{status}</if>            <if test="sortOrder != null and sortOrder != ''">,sort_order = #{sortOrder}</if>            <if test="primaryPerson != null and primaryPerson != ''">,primary_person = #{primaryPerson}</if>            <if test="deputyPerson != null and deputyPerson != ''">,deputy_person = #{deputyPerson}</if>            <if test="remark != null and remark != ''">,remark = #{remark}</if>        </trim>    </sql>    <sql id="sql_condition">        <if test="id != null and id != ''">AND id = #{id}</if>        <if test="name != null and name != ''">AND name = #{name}</if>        <if test="shortName != null and shortName != ''">AND short_name = #{shortName}</if>        <if test="grade != null and grade != ''">AND grade = #{grade}</if>        <if test="pid != null and pid != ''">AND pid = #{pid}</if>        <if test="createTime != null">AND create_time = #{createTime}</if>        <if test="createUser != null and createUser != ''">AND create_user = #{createUser}</if>        <if test="status != null and status != ''">AND status = #{status}</if>        <if test="sortOrder != null and sortOrder != ''">AND sort_order = #{sortOrder}</if>        <if test="primaryPerson != null and primaryPerson != ''">AND primary_person = #{primaryPerson}</if>        <if test="deputyPerson != null and deputyPerson != ''">AND deputy_person = #{deputyPerson}</if>        <if test="remark != null and remark != ''">AND remark = #{remark}</if>    </sql>    <select id="listTree" resultType="com.ruxuanwo.template.dto.TreeNode">	SELECT    t.id,`name`,pid    FROM    sys_department t</select>    <select id="selectByPid" resultType="com.ruxuanwo.template.dto.SysDepartmentDTO">        SELECT        t.*,        a.NAME AS primaryName,        b.NAME AS deputyName,        d.name AS pname        FROM        sys_department t        left JOIN(        SELECT        d.name,id        FROM        sys_department d        ) d ON d.id=t.pid        LEFT JOIN ( SELECT u.id, NAME FROM sys_user u ) a ON a.id = t.primary_person        LEFT JOIN ( SELECT u.id, NAME FROM sys_user u ) b ON b.id = t.deputy_person        where 1=1        <if test="map.pid!=null and map.pid!=''">and t.pid=#{map.pid}</if>        <if test="map.name!=null and map.name!=''">and t.name like concat("%",#{map.name},"%")</if>        <if test="map.pname!=null and map.pname!=''">and d.name like concat("%",#{map.pname},"%")</if>    </select>    <select id="findByUserId" resultMap="department">		SELECT d.*		FROM sys_department d, sys_user_department ud		WHERE		d.id = ud.department_id		AND ud.user_id = #{userId}	</select>    <select id="listDtoById" resultType="com.ruxuanwo.template.dto.SysDepartmentDTO">        SELECT        a.name AS pname,b.*,c.name AS primaryName,d.name AS deputyName        FROM        sys_department a        JOIN(SELECT        d.*        FROM        sys_department d        ) b ON a.id=b.pid        LEFT JOIN(SELECT u.id,name        FROM        sys_user u) c ON c.id=b.primary_person        LEFT JOIN(SELECT u.id,name        FROM        sys_user u) d ON d.id=b.deputy_person        where b.id=#{map.id}    </select></mapper>